<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attendance App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://raw.githubusercontent.com/SidharthT-TechExpert/attendance-tracker/refs/heads/main/Img/logo.webp"
    rel="icon">
  <link rel="stylesheet" href="/styles/style.css">
</head>

<body>
  <!-- Loader -->
  <div id="loader">
    <div class="orbit orbit-outer">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    <div class="orbit orbit-inner">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    <div class="circle">
      <div class="twoQuarterBig"></div>
      <div class="twoQuarterSmall"></div>
      <div class="circleSmall"></div>
    </div>
    <div class="loading-text">Loading<span class="percent">0%</span></div>
  </div>

  <!-- ================= MAIN APP ================= -->

  <!-- Header section -->
  <header class="text-center text-white p-3 y">
    <h4 class="m-0">Attendance Tracker</h4>
    <small id="currentDate"></small>
    <p class="mb-2">Welcome to the Attendance Tracker. Easily record and manage attendance for your sessions.</p>
    <div>
      <button id="manageBtn" class="btn btn-outline-light btn-sm me-2">üìö Manage Batches</button>
    </div>
  </header>

  <!-- Main Content -->
  <div id="mainContent" style="display: none;">
    <div class="container py-4">
      <div class="row justify-content-center">
        <div class="col-lg-12 col-md-10">
          <div class="container-box">
            <!-- Batch Selection -->
            <div class="p-3 bg-light border rounded mb-3 text-dark fw-bold">
              <div class="row">
                <div class="col-md-6">
                  <select id="batchSelect" class="form-select mb-2" onchange="loadBatch()">
                  </select>
                  <span id="selectedBatchTitle"></span>
                </div>
                <div class="col-md-6" id="notifications" style="display: none;">
                  <div class="text-dark fw-bold">
                    <small>‚úÖ Present: Default</small><br>
                    <small>üü® Alternative CS</small><br>
                    <small>‚ùå Absent</small>
                  </div>
                </div>
              </div>
              <hr>
              <!-- Groups -->
              <div id="groups" style="display: none;">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="group1" name="group" value="group1">
                  <label class="form-check-label" for="group1">Group 1</label>
                </div>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="group2" name="group" value="group2">
                  <label class="form-check-label" for="group2">Group 2</label>
                </div>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="combined" name="group"
                    value="combined">
                  <label class="form-check-label" for="combined">Combined</label>
                </div>
              </div>
            </div>

            <div class="row g-3 " id="importData" style="display: none;">
              <!-- Session Time -->
              <div class="custom-dropdownH col-md-4 time-selection">
                <label for="time" class="form-labelH">‚è∞ Select Time</label>
                <button id="Time" class="dropdown-btnH">‚è∞ Select Time <span class="arrow">‚åÑ</span></button>
                <ul class="dropdown-menuH">
                  <li>10:00 AM - 11:00 AM</li>
                  <li>10:30 AM - 11:30 AM</li>
                  <li>11:00 AM - 12:00 PM</li>
                  <li>11:30 AM - 12:30 PM</li>
                  <li>12:00 PM - 01:00 PM</li>
                  <li>12:30 PM - 01:30 PM</li>
                  <li>01:00 PM - 02:00 PM</li>
                  <li>01:30 PM - 02:30 PM</li>
                  <li>02:00 PM - 03:00 PM</li>
                  <li>02:30 PM - 03:30 PM</li>
                  <li>03:00 PM - 04:00 PM</li>
                  <li>03:30 PM - 04:30 PM</li>
                  <li>04:00 PM - 05:00 PM</li>
                  <li>04:30 PM - 05:30 PM</li>
                  <li>05:00 PM - 06:00 PM</li>
                  <li>05:30 PM - 06:30 PM</li>
                  <li>06:00 PM - 07:00 PM</li>
                  <li>06:30 PM - 07:30 PM</li>
                  <li>07:00 PM - 08:00 PM</li>
                  <li>07:30 PM - 08:30 PM</li>
                  <li>08:00 PM - 09:00 PM</li>
                  <li>08:30 PM - 09:30 PM</li>
                  <li>09:00 PM - 10:00 PM</li>
                  <li>09:30 PM - 10:30 PM</li>
                  <li>10:00 PM - 11:00 PM</li>
                </ul>
                <input type="hidden" id="timeH">
              </div>


              <!-- TLDV Link -->
              <div class="col-md-4 time-selection">
                <label for="tldv" class="form-label">üìπ TLDV Link</label>
                <input type="url" id="tldv" class="form-control fw-bold" placeholder="Paste TLDV link">
              </div>

              <!-- Meet List -->
              <div class="col-md-4 time-selection">
                <label for="meetlist" class="form-label">üìã Meet List Link</label>
                <input type="url" id="meetlist" class="form-control fw-bold" placeholder="Paste Meet list link">
              </div>

              <!-- Enter Your Name -->
              <div class="col-md-4 time-selection">
                <label for="reportBy" class="form-label">ü´µ Enter Your Name</label>
                <input type="text" id="reportBy" class="form-control fw-bold" placeholder="Enter your name"
                  autocomplete="off">
              </div>

              <!-- Session Overview -->
              <div class="col-md-4 time-selection">
                <label for="over" class="form-label">‚ôª Session Overview</label>
                <textarea type="text" id="over" class="form-control fw-bold"
                  placeholder="Paste your session overview here" autocomplete="off"></textarea>
              </div>

              <!-- Other Batches -->
              <div class="col-md-4 time-selection">
                <label for="Batch" class="form-label">ü§© Other Batches</label>
                <input type="text" id="Batch" class="form-control fw-bold" placeholder="Enter names with commas"
                  autocomplete="off">
              </div>
            </div>

            <hr>
            <div class="alt-cs-text" id="list"></div>
            <hr>
            <button class="btn btn-custom w-100 mt-3" onclick="generateOutput()">Generate Output</button>
            <hr>

            <div class="d-flex flex-wrap justify-content-between align-items-center mt-3">

              <!-- Output label -->
              <span id="none"><strong id="outputtext"
                  style="font-size: larger; font-weight: bolder;">Output</strong></span>

              <!-- Toolbar -->
              <div id="outputToolbar" style="display: none;" class="btn-group mt-2 mt-md-0 output-toolbar" role="group"
                aria-label="Output Toolbar">
                <button class="btn btn-outline-primary btn-sm copy-btn" onclick="copyOutput()">
                  üìã Copy
                </button>
                <button class="btn btn-outline-success btn-sm download-btn" onclick="downloadReport()">
                  üì• Download .txt
                </button>
                <button id="editBtn" class="btn btn-outline-warning btn-sm edit-btn" onclick="toggleEdit()">
                  ‚úèÔ∏è Edit
                </button>
              </div>
            </div>


            <hr>
            <!-- View Mode -->
            <pre id="outputView" class="form-control" style="padding-top: 35px; white-space: pre-dark;"></pre>

            <!-- Edit Mode -->
            <textarea id="outputEdit" class="form-control" style="padding-top: 35px; display:none;"></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loader Script -->
  <script src="src/loader.js"></script>
  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- Firebase first -->
  <script type="module" src="src/script.js"></script>


  <!-- Button that opens the protected manager area -->
  <script type="module">
    //Helper to get element by ID
    const $ = (id) => document.getElementById(id);
    
    import { authenticateAndRedirect } from "./src/auth.js";
    const btn = $("manageBtn");
    if (btn) btn.addEventListener("click", authenticateAndRedirect);

    $("none").style.display = "none";
  </script>

</body>

</html>